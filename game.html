<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>LifeSim</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; padding: 20px; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.08); }
        .typing::after { content: '|'; animation: blink 1s step-start infinite; }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row gap-6">

    <div class="w-full md:w-1/3 flex flex-col gap-4">
        <div class="glass p-4 rounded-xl border-l-4 border-blue-500">
            <h2 class="font-bold text-blue-400 mb-2">SENARYO SEÇİMİ</h2>
            <select id="scenarioSelect" onchange="loadScenario()" class="w-full bg-slate-900 text-white p-2 rounded border border-slate-700 outline-none">
            </select>
        </div>

        <div class="glass p-6 rounded-xl flex-1 flex flex-col">
            <span id="categoryBadge" class="self-start px-2 py-1 bg-slate-700 text-xs rounded mb-3">KATEGORİ</span>
            <h2 id="scenarioTitle" class="text-xl font-bold mb-4">Yükleniyor...</h2>
            <div id="scenarioText" class="text-slate-300 text-sm flex-1 overflow-y-auto mb-4"></div>
            <div class="bg-slate-800 p-3 rounded text-xs text-blue-300 font-mono">
                <ul id="scenarioData"></ul>
            </div>
        </div>
    </div>

    <div class="w-full md:w-2/3 flex flex-col gap-4">
        <div class="glass p-4 rounded-xl flex gap-4 min-h-[100px]">
            <i data-lucide="bot" class="text-blue-400 mt-1"></i>
            <div class="flex-1">
                <div class="text-xs text-blue-400 font-bold mb-1">AI DANIŞMAN</div>
                <div id="aiFeedback" class="text-sm text-slate-200 typing">Sistem hazır.</div>
            </div>
        </div>

        <div class="glass p-1 rounded-xl flex-1 relative flex flex-col border border-slate-700">
            <textarea id="inputText" class="w-full h-full bg-transparent p-6 text-slate-200 resize-none outline-none font-mono" placeholder="// Stratejini buraya yaz..."></textarea>
            <div class="absolute bottom-4 right-4">
                <button onclick="analyze()" id="actionBtn" class="bg-blue-500 hover:bg-blue-400 text-white font-bold px-6 py-2 rounded shadow transition-transform active:scale-95 flex items-center gap-2">
                    <i data-lucide="zap" size="16"></i> ANALİZ ET
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- VERİ ENJEKSİYONU ---
        // Bu satırı app.py değiştirecek. SAKIN SİLME.
        // PYTHON_DATA_HERE
        
        // Hata önleyici
        if (typeof scenarios === 'undefined') scenarios = [{title: "Hata", text: "Veri yüklenemedi.", category: "Error", data: [], keywords:{}}];

        let currentScenario = null;

        function loadScenarioDropdown() {
            const sel = document.getElementById('scenarioSelect');
            sel.innerHTML = "";
            scenarios.forEach((s, i) => {
                let opt = document.createElement('option');
                opt.value = i; opt.innerText = s.title;
                sel.appendChild(opt);
            });
            loadScenario(0);
        }

        function loadScenario(idx = null) {
            if(idx === null) idx = document.getElementById('scenarioSelect').value;
            currentScenario = scenarios[idx];
            
            document.getElementById('categoryBadge').innerText = currentScenario.category;
            document.getElementById('scenarioTitle').innerText = currentScenario.title;
            document.getElementById('scenarioText').innerText = currentScenario.text;
            
            let dataHtml = "";
            if(currentScenario.data) currentScenario.data.forEach(d => dataHtml += `<li>> ${d}</li>`);
            document.getElementById('scenarioData').innerHTML = dataHtml;
            
            document.getElementById('inputText').value = "";
            document.getElementById('aiFeedback').innerHTML = "Analiz bekleniyor...";
            document.getElementById('actionBtn').disabled = false;
            document.getElementById('actionBtn').innerHTML = "ANALİZ ET";
            document.getElementById('actionBtn').className = "bg-blue-500 hover:bg-blue-400 text-white font-bold px-6 py-2 rounded shadow transition-transform active:scale-95 flex items-center gap-2";
        }

        function analyze() {
            const txt = document.getElementById('inputText').value.toLowerCase();
            const btn = document.getElementById('actionBtn');
            const feed = document.getElementById('aiFeedback');

            if(txt.length < 5) return alert("Daha detaylı yaz.");

            btn.innerText = "İnceleniyor...";
            btn.disabled = true;

            setTimeout(() => {
                let score = 0;
                let missing = [];
                const keys = currentScenario.keywords || {};
                const total = Object.keys(keys).length;

                for(let k in keys) {
                    if(txt.includes(k)) score++;
                    else missing.push(keys[k]);
                }

                const success = total === 0 || (score/total) >= 0.5;

                if(success) {
                    feed.innerHTML = `<span class="text-green-400 font-bold">BAŞARILI!</span><br>${currentScenario.hapBilgi}`;
                    btn.innerText = "TAMAMLANDI";
                    btn.className = "bg-green-500 text-black font-bold px-6 py-2 rounded cursor-default";
                } else {
                    feed.innerHTML = `<span class="text-yellow-400 font-bold">EKSİK VAR:</span><br>${missing[0] || 'Detaylandır.'}`;
                    btn.innerText = "TEKRAR DENE";
                    btn.disabled = false;
                }
            }, 800);
        }

        window.onload = function() {
            lucide.createIcons();
            loadScenarioDropdown();
        }
    </script>
</body>
</html>
